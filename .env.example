# HP_TI Environment Configuration
# Copy this file to .env and fill in your values
# Never commit .env to version control!

# ============================================================================
# General Application Settings
# ============================================================================

# Environment (development, staging, production)
ENVIRONMENT=development

# Log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# Log format (json, text)
LOG_FORMAT=json

# Application name
APP_NAME=HP_TI

# Timezone for logging
TZ=UTC

# ============================================================================
# Honeypot Configuration
# ============================================================================

# SSH Honeypot
HONEYPOT_SSH_ENABLED=true
HONEYPOT_SSH_HOST=0.0.0.0
HONEYPOT_SSH_PORT=2222
HONEYPOT_SSH_BANNER="SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.1"

# HTTP Honeypot
HONEYPOT_HTTP_ENABLED=true
HONEYPOT_HTTP_HOST=0.0.0.0
HONEYPOT_HTTP_PORT=8080
HONEYPOT_HTTPS_PORT=8443

# Telnet Honeypot
HONEYPOT_TELNET_ENABLED=false
HONEYPOT_TELNET_HOST=0.0.0.0
HONEYPOT_TELNET_PORT=2323

# FTP Honeypot
HONEYPOT_FTP_ENABLED=false
HONEYPOT_FTP_HOST=0.0.0.0
HONEYPOT_FTP_PORT=2121

# Honeypot Log Directory
HONEYPOT_LOG_DIR=./logs/honeypots

# Session timeout (seconds)
HONEYPOT_SESSION_TIMEOUT=300

# Max connections per IP
HONEYPOT_MAX_CONNECTIONS_PER_IP=5

# ============================================================================
# Database Configuration
# ============================================================================

# PostgreSQL
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=hp_ti_db
POSTGRES_USER=hp_ti_user
POSTGRES_PASSWORD=changeme_postgres_password
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}

# PostgreSQL Pool Settings
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
DB_POOL_TIMEOUT=30

# Elasticsearch
ELASTICSEARCH_HOST=localhost
ELASTICSEARCH_PORT=9200
ELASTICSEARCH_SCHEME=http
ELASTICSEARCH_URL=${ELASTICSEARCH_SCHEME}://${ELASTICSEARCH_HOST}:${ELASTICSEARCH_PORT}
ELASTICSEARCH_USERNAME=elastic
ELASTICSEARCH_PASSWORD=changeme_elastic_password

# Elasticsearch Index Settings
ELASTICSEARCH_INDEX_PREFIX=hp_ti
ELASTICSEARCH_INDEX_REPLICAS=1
ELASTICSEARCH_INDEX_SHARDS=3

# Redis
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=changeme_redis_password
REDIS_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB}

# Redis Cache Settings
REDIS_CACHE_TTL=86400
REDIS_MAX_CONNECTIONS=50

# ============================================================================
# Threat Intelligence APIs
# ============================================================================

# AbuseIPDB
# Get your API key at: https://www.abuseipdb.com/api
ABUSEIPDB_API_KEY=your_abuseipdb_api_key_here
ABUSEIPDB_ENABLED=true
ABUSEIPDB_RATE_LIMIT=1000  # requests per day for free tier
ABUSEIPDB_CACHE_TTL=21600  # 6 hours in seconds

# VirusTotal
# Get your API key at: https://www.virustotal.com/gui/my-apikey
VIRUSTOTAL_API_KEY=your_virustotal_api_key_here
VIRUSTOTAL_ENABLED=false
VIRUSTOTAL_RATE_LIMIT=4  # requests per minute for free tier
VIRUSTOTAL_CACHE_TTL=86400  # 24 hours in seconds

# MaxMind GeoIP
# Download GeoLite2 database from: https://dev.maxmind.com/geoip/geolite2-free-geolocation-data
MAXMIND_ENABLED=true
MAXMIND_DB_PATH=./data/GeoLite2-City.mmdb
MAXMIND_CACHE_TTL=604800  # 7 days in seconds

# IP Quality Score
# Get your API key at: https://www.ipqualityscore.com/
IPQUALITYSCORE_API_KEY=your_ipqualityscore_api_key_here
IPQUALITYSCORE_ENABLED=false
IPQUALITYSCORE_CACHE_TTL=86400  # 24 hours in seconds

# Shodan
# Get your API key at: https://account.shodan.io/
SHODAN_API_KEY=your_shodan_api_key_here
SHODAN_ENABLED=false
SHODAN_CACHE_TTL=604800  # 7 days in seconds

# AlienVault OTX
# Get your API key at: https://otx.alienvault.com/
ALIENVAULT_OTX_API_KEY=your_alienvault_otx_api_key_here
ALIENVAULT_OTX_ENABLED=false
ALIENVAULT_OTX_CACHE_TTL=86400  # 24 hours in seconds

# ============================================================================
# Data Pipeline Configuration
# ============================================================================

# Ingestion Settings
PIPELINE_BATCH_SIZE=100
PIPELINE_FLUSH_INTERVAL=10  # seconds
PIPELINE_WORKER_COUNT=4
PIPELINE_QUEUE_SIZE=10000

# Processing Settings
PIPELINE_ENABLE_ENRICHMENT=true
PIPELINE_ENABLE_CORRELATION=true
PIPELINE_RETRY_ATTEMPTS=3
PIPELINE_RETRY_DELAY=5  # seconds

# Dead Letter Queue
DLQ_ENABLED=true
DLQ_PATH=./logs/dead_letter_queue

# ============================================================================
# Monitoring & Metrics
# ============================================================================

# Prometheus
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090
METRICS_EXPORT_PORT=8000

# Grafana
GRAFANA_ENABLED=true
GRAFANA_PORT=3000
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=changeme_grafana_password

# Kibana
KIBANA_ENABLED=true
KIBANA_PORT=5601

# Health Check
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PORT=8888
HEALTH_CHECK_INTERVAL=30  # seconds

# ============================================================================
# Alerting Configuration
# ============================================================================

# Alert Manager
ALERTING_ENABLED=true

# Email Alerts
EMAIL_ALERTS_ENABLED=false
EMAIL_SMTP_HOST=smtp.gmail.com
EMAIL_SMTP_PORT=587
EMAIL_SMTP_USER=your_email@example.com
EMAIL_SMTP_PASSWORD=your_email_password
EMAIL_FROM_ADDRESS=hp_ti@example.com
EMAIL_TO_ADDRESSES=security@example.com,admin@example.com

# Slack Alerts
SLACK_ALERTS_ENABLED=false
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
SLACK_CHANNEL=#security-alerts
SLACK_USERNAME=HP_TI Alert Bot

# Discord Alerts
DISCORD_ALERTS_ENABLED=false
DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/YOUR/WEBHOOK/URL

# PagerDuty
PAGERDUTY_ENABLED=false
PAGERDUTY_INTEGRATION_KEY=your_pagerduty_integration_key

# Alert Thresholds
ALERT_THRESHOLD_HIGH_AUTH_RATE=100  # auth attempts in 5 minutes
ALERT_THRESHOLD_COORDINATED_ATTACK=10  # same creds from N IPs
ALERT_THRESHOLD_SERVICE_DOWN=120  # seconds
ALERT_THRESHOLD_ERROR_RATE=5  # percentage

# ============================================================================
# Reporting Configuration
# ============================================================================

# Report Generation
REPORTS_ENABLED=true
REPORTS_OUTPUT_DIR=./reports
REPORTS_DAILY_ENABLED=true
REPORTS_DAILY_SCHEDULE=0 8 * * *  # 8 AM daily (cron format)
REPORTS_WEEKLY_ENABLED=true
REPORTS_WEEKLY_SCHEDULE=0 9 * * 1  # 9 AM every Monday

# Report Delivery
REPORTS_EMAIL_ENABLED=false
REPORTS_EMAIL_TO=reports@example.com

# ============================================================================
# Security Settings
# ============================================================================

# Secrets Management
SECRETS_BACKEND=env  # env, vault, aws_secrets

# HashiCorp Vault (if using)
VAULT_ENABLED=false
VAULT_ADDR=http://localhost:8200
VAULT_TOKEN=your_vault_token
VAULT_PATH=secret/hp_ti

# Encryption
DATA_ENCRYPTION_ENABLED=true
ENCRYPTION_KEY=your_encryption_key_32_bytes_min

# API Security (if exposing APIs)
API_ENABLED=false
API_PORT=5000
API_SECRET_KEY=your_api_secret_key_here
API_CORS_ORIGINS=http://localhost:3000,https://yourdomain.com
API_RATE_LIMIT=100  # requests per minute

# ============================================================================
# Development Settings
# ============================================================================

# Debug Mode (NEVER enable in production!)
DEBUG=false

# Auto-reload (development only)
AUTO_RELOAD=false

# Profiling
PROFILING_ENABLED=false

# Sample Data Generation
GENERATE_SAMPLE_DATA=false
SAMPLE_DATA_RATE=10  # events per minute

# ============================================================================
# Deployment Settings
# ============================================================================

# Docker
DOCKER_REGISTRY=docker.io
DOCKER_NAMESPACE=hp_ti

# Container Resources
CONTAINER_MEMORY_LIMIT=2G
CONTAINER_CPU_LIMIT=2

# Kubernetes (if using)
K8S_NAMESPACE=hp-ti
K8S_REPLICAS=3

# ============================================================================
# Backup & Recovery
# ============================================================================

# Backup Settings
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # 2 AM daily
BACKUP_RETENTION_DAYS=30
BACKUP_DESTINATION=s3://your-bucket/backups

# S3/Object Storage (for backups)
AWS_ACCESS_KEY_ID=your_aws_access_key
AWS_SECRET_ACCESS_KEY=your_aws_secret_key
AWS_REGION=us-east-1
S3_BACKUP_BUCKET=hp-ti-backups

# ============================================================================
# Feature Flags
# ============================================================================

# Enable/disable specific features
FEATURE_MACHINE_LEARNING=false
FEATURE_ADVANCED_CORRELATION=false
FEATURE_MISP_INTEGRATION=false
FEATURE_PUBLIC_API=false
FEATURE_THREAT_HUNTING=false

# ============================================================================
# Performance Tuning
# ============================================================================

# Worker Processes
WORKER_PROCESSES=4

# Thread Pool Size
THREAD_POOL_SIZE=10

# Async Event Loop
EVENT_LOOP_POLICY=uvloop  # uvloop or asyncio

# Connection Timeouts
HTTP_TIMEOUT=10  # seconds
DB_TIMEOUT=30  # seconds
CACHE_TIMEOUT=5  # seconds

# ============================================================================
# Testing Configuration (for test environment)
# ============================================================================

# Test Database
TEST_DATABASE_URL=postgresql://test_user:test_pass@localhost:5432/hp_ti_test

# Mock External APIs
MOCK_EXTERNAL_APIS=false

# Test Data
TEST_DATA_PATH=./tests/fixtures
